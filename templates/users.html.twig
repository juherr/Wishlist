{% extends "base.html.twig" %}

{% block stylesheets %}
    {{ encore_entry_link_tags('users') }}
{% endblock %}

{% block javascripts %}
    {{ encore_entry_script_tags('users') }}
    <script>
        const route_booking_delete = "{{ path('booking_delete')|escape('js') }}";
    </script>
{% endblock %}

{% block content %}
    {% for user in users %}
        <div class="user" id="user{{ user.id }}">
            <div class="illu">
                <img src='{{ asset("build/perso#{user.iconId}.png") }}'/>
            </div>

            <div class="wrapper-username">
                <h2>{{ user.name }}</h2>
                {% if loggedUser.id is not defined %}
                    <span class="ico-delete-user">
                        <svg viewBox="0 0 100 100" class="icon">
                            <use xlink:href="#icon-ico-trash"></use>
                        </svg>
                    </span>
                    <span class="ico-edit-user">
                        <svg viewBox="0 0 100 100" class="icon">
                            <use xlink:href="#icon-ico-edit"></use>
                        </svg>
                    </span>

                    <form class="wrapper-bt wrapper-add" action="{{ path('login') }}" method="post">
                        <input type="hidden" value="{{ user.id }}" name="id_personne"/>
                        <input type="submit" value="{{ 'i_am'|trans({ '%name%': user.name }) }}" class="bt"/>
                    </form>

                    <div class="confirmation-suppression">
                        <p>{{ 'delete.confirmation'|trans }}</p>
                        <form action="{{ path('user_delete') }}" method="post">
                            <input type="hidden" value="{{ user.id }}" name="user-id"/>
                            <input type="submit" class="confirm-suppression bt" value="{{ 'yes'|trans }}"/>
                        </form>
                        <p class="annuler-suppression">{{ 'delete.cancel'|trans }}</p>
                    </div>
                {% endif %}
            </div>

            {% if loggedUser.id is not defined or user.id == loggedUser.id %}
                <div class="edit-user">
                    <form action="{{ path('user_update') }}" method="post">
                        <input type="hidden" value="{{ user.id }}" name="id_personne"/>

                        <div class="wrapper-gift-input">
                                <span>
                                    <svg viewBox="0 0 100 100" class="icon">
                                        <use xlink:href="#icon-ico-user"></use>
                                    </svg>
                                </span>
                            <input class="input-name" type="text" name="username" required
                                   placeholder="{{ 'user.placeholder.name'|trans }}"
                                   value="{{ user.name }}"/>
                        </div>

                        <h3>{{ 'user.icon'|trans }}</h3>
                        <div class="wrapper-illus">
                            <div class="wrapper-illustration">
                                <input name="choix-illu{{ user.id }}" type="radio"
                                       id="radio1-{{ user.id }}" value="1" class="perso1"
                                        {{ user.iconId == 1 ? 'checked' }}/>
                                <label for="radio1-{{ user.id }}">
                                    <img src="{{ asset('build/perso1.png') }}" alt=""/>
                                </label>
                            </div>

                            {% for i in range(2, 8) %}
                                <div class="wrapper-illustration">
                                    <input value="{{ i }}" name="choix-illu{{ user.id }}" type="radio"
                                           id="radio{{ i }}-{{ user.id }}"
                                           class="perso{{ i }}" {{ user.iconId == i ? 'checked' }}/>
                                    <label for="radio{{ i }}-{{ user.id }}">
                                        <img src='{{ asset("build/perso#{i}.png") }}' alt=""/>
                                    </label>
                                </div>
                            {% endfor %}
                        </div>

                        <div class="wrapper-bt wrapper-add">
                            <input type="submit" value="{{ 'user.edit.confirm'|trans }}" class="bt"/>
                        </div>

                        <div class="wrapper-bt">
                            <span class="cancel-add-user bt-cancel">{{ 'cancel'|trans }}</span>
                        </div>
                    </form>
                </div>
            {% endif %}
            {% block extra %}{% endblock %}
        </div>
    {% endfor %}

    {% if loggedUser.id is not defined %}
        <div class="modal-add-user modal-user user" id="modal-add-user">
            <form action="{{ path('user_add') }}" method="post">
                <div class="illu">
                    <img src="{{ asset('build/perso1.png') }}" alt=""/>
                </div>

                <h2>{{ 'user.add.title'|trans }}</h2>
                <div class="wrapper-gift-input">
                    <span>
                        <svg viewBox="0 0 100 100" class="icon">
                            <use xlink:href="#icon-ico-user"></use>
                        </svg>
                    </span>
                    <input class="input-name" type="text" name="username" required
                           placeholder="{{ 'user.placeholder.name'|trans }}"/>
                </div>

                <h3>{{ 'user.icon'|trans }}</h3>
                <div class="wrapper-illus">
                    <div class="wrapper-illustration">
                        <input name="choix-illu" type="radio" id="radio1" checked value="1" class="perso1"/>
                        <label for="radio1"><img src="{{ asset('build/perso1.png') }}" alt=""></label>
                    </div>

                    {% for i in range(2, 8) %}
                        <div class="wrapper-illustration">
                            <input value="{{ i }}" name="choix-illu" type="radio" id="radio{{ i }}"
                                   class="perso{{ i }}"/>
                            <label for="radio{{ i }}"><img src='{{ asset("build/perso#{i}.png") }}' alt=""/></label>
                        </div>
                    {% endfor %}
                </div>

                <div class="wrapper-bt wrapper-add">
                    <input type="submit" value="{{ 'user.add.action'|trans }}" class="bt"/>
                </div>

                <div class="wrapper-bt">
                    <span class="cancel-add-user bt-cancel">{{ 'cancel'|trans }}</span>
                </div>
            </form>
        </div>
    {% endif %}
{% endblock %}

{% block post_content %}
    {% if loggedUser.id is not defined %}
        <div class="add-user">
            <button class="bt">{{ 'user.add.title'|trans }}</button>
        </div>
    {% endif %}
{% endblock %}
